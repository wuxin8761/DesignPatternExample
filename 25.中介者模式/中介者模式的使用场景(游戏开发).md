ä¸­ä»‹è€…æ¨¡å¼ï¼ˆMediator Patternï¼‰åœ¨æ¸¸æˆå¼€å‘ä¸­å…·æœ‰å¹¿æ³›çš„é€‚ç”¨åœºæ™¯ï¼Œå°¤å…¶æ˜¯åœ¨éœ€è¦å¤šä¸ªå¯¹è±¡ä¹‹é—´åè°ƒäº¤äº’ä½†åˆä¸å¸Œæœ›å½¼æ­¤ç›´æ¥è€¦åˆçš„æƒ…å†µä¸‹ã€‚
ä»¥ä¸‹æ˜¯ä¸­ä»‹è€…æ¨¡å¼åœ¨æ¸¸æˆå¼€å‘ä¸­çš„å…¸å‹ä½¿ç”¨åœºæ™¯ï¼š

---

### ä¸€ã€æ¸¸æˆå¯¹è±¡ä¹‹é—´çš„é€šä¿¡åè°ƒ

#### åœºæ™¯æè¿°ï¼š
åœ¨æ¸¸æˆä¸­ï¼Œå¤šä¸ªæ¸¸æˆå¯¹è±¡ï¼ˆå¦‚ç©å®¶ã€æ•Œäººã€UIã€éŸ³æ•ˆç³»ç»Ÿç­‰ï¼‰éœ€è¦ç›¸äº’é€šä¿¡æˆ–å“åº”äº‹ä»¶ï¼Œä¾‹å¦‚ï¼š
- ç©å®¶æ­»äº¡æ—¶é€šçŸ¥UIæ›´æ–°ã€æš‚åœæ•Œäººè¡Œä¸ºã€æ’­æ”¾éŸ³æ•ˆã€‚
- æ•Œäººè¢«å‡»è´¥æ—¶é€šçŸ¥å¾—åˆ†ç³»ç»ŸåŠ åˆ†ã€è§¦å‘ç‰¹æ•ˆã€‚

#### ä½¿ç”¨ä¸­ä»‹è€…çš„å¥½å¤„ï¼š
é€šè¿‡å¼•å…¥ä¸€ä¸ª`GameMediator`ç±»ï¼Œå°†è¿™äº›å¯¹è±¡ä¹‹é—´çš„äº¤äº’é€»è¾‘é›†ä¸­ç®¡ç†ï¼Œé¿å…å¯¹è±¡é—´çš„ç›´æ¥å¼•ç”¨å’Œè€¦åˆã€‚

```csharp
public interface IGameMediator
{
    void Notify(object sender, string eventName);
}

public class GameMediator : IGameMediator
{
    private Player _player;
    private UIManager _uiManager;
    private EnemyManager _enemyManager;

    public GameMediator(Player player, UIManager uiManager, EnemyManager enemyManager)
    {
        _player = player;
        _uiManager = uiManager;
        _enemyManager = enemyManager;
    }

    public void Notify(object sender, string eventName)
    {
        switch (eventName)
        {
            case "PlayerDied":
                _uiManager.ShowGameOver();
                _enemyManager.PauseAllEnemies();
                break;
            case "EnemyKilled":
                _uiManager.UpdateScore(100);
                break;
        }
    }
}
```


---

### äºŒã€æ¸¸æˆçŠ¶æ€ç®¡ç†ç³»ç»Ÿ

#### åœºæ™¯æè¿°ï¼š
æ¸¸æˆæœ‰å¤šç§çŠ¶æ€ï¼ˆå¦‚è¿è¡Œä¸­ã€æš‚åœã€èƒœåˆ©ã€å¤±è´¥ï¼‰ï¼Œä¸åŒæ¨¡å—éœ€è¦æ ¹æ®å½“å‰çŠ¶æ€åšå‡ºååº”ã€‚

#### ä½¿ç”¨ä¸­ä»‹è€…çš„å¥½å¤„ï¼š
ä¸­ä»‹è€…å¯ä»¥ç»Ÿä¸€ç®¡ç†çŠ¶æ€å˜åŒ–ï¼Œå¹¶é€šçŸ¥æ‰€æœ‰ç›¸å…³æ¨¡å—è¿›è¡Œå“åº”ï¼Œè€Œä¸éœ€è¦æ¯ä¸ªæ¨¡å—ç›‘å¬å…¶ä»–æ¨¡å—çš„çŠ¶æ€ã€‚

```csharp
public class GameStateMediator
{
    public event Action<GameState> OnStateChanged;

    public void ChangeState(GameState newState)
    {
        OnStateChanged?.Invoke(newState);
    }
}

// å„æ¨¡å—è®¢é˜…
uiManager.OnStateChanged += HandleStateChange;
audioManager.OnStateChanged += HandleStateChange;
```


---

### ä¸‰ã€UIç»„ä»¶ä¹‹é—´çš„è”åŠ¨

#### åœºæ™¯æè¿°ï¼š
æ¸¸æˆä¸­çš„å¤šä¸ªUIç»„ä»¶ï¼ˆå¦‚æŒ‰é’®ã€æ»‘å—ã€æ–‡æœ¬æ¡†ï¼‰ä¹‹é—´å­˜åœ¨è”åŠ¨å…³ç³»ï¼Œæ¯”å¦‚ï¼š
- éŸ³é‡æ»‘å—æ”¹å˜æ—¶ï¼Œæ–‡æœ¬æ˜¾ç¤ºå½“å‰æ•°å€¼ï¼›
- æŒ‰ä¸‹â€œå¼€å§‹â€æŒ‰é’®æ—¶å…³é—­è®¾ç½®é¢æ¿å¹¶å¯åŠ¨æ¸¸æˆã€‚

#### ä½¿ç”¨ä¸­ä»‹è€…çš„å¥½å¤„ï¼š
é€šè¿‡ä¸­ä»‹è€…é›†ä¸­å¤„ç†UIç»„ä»¶ä¹‹é—´çš„è”åŠ¨é€»è¾‘ï¼Œé¿å…ç»„ä»¶é—´äº’ç›¸æŒæœ‰å¼•ç”¨ï¼Œæå‡å¯ç»´æŠ¤æ€§ã€‚

---

### å››ã€äº‹ä»¶å¹¿æ’­ç³»ç»Ÿï¼ˆEvent Bus çš„ç®€åŒ–ç‰ˆï¼‰

#### åœºæ™¯æè¿°ï¼š
æ¸¸æˆä¸­éœ€è¦å¹¿æ’­å’Œç›‘å¬å„ç§äº‹ä»¶ï¼Œå¦‚æŠ€èƒ½é‡Šæ”¾ã€ç‰©å“æ‹¾å–ã€ä»»åŠ¡å®Œæˆç­‰ã€‚

#### ä½¿ç”¨ä¸­ä»‹è€…çš„å¥½å¤„ï¼š
ä¸­ä»‹è€…å¯ä»¥ä½œä¸ºè½»é‡çº§çš„äº‹ä»¶æ€»çº¿ï¼Œè´Ÿè´£äº‹ä»¶çš„å‘å¸ƒä¸è®¢é˜…ï¼Œä½¿å¾—å„ä¸ªç³»ç»Ÿä¹‹é—´è§£è€¦ã€‚

```csharp
public class EventMediator
{
    private Dictionary<string, List<Action<object>>> _listeners = new();

    public void Subscribe(string eventName, Action<object> handler)
    {
        if (!_listeners.ContainsKey(eventName))
            _listeners[eventName] = new List<Action<object>>();
        
        _listeners[eventName].Add(handler);
    }

    public void Publish(string eventName, object data)
    {
        if (_listeners.TryGetValue(eventName, out var handlers))
        {
            foreach (var handler in handlers)
            {
                handler(data);
            }
        }
    }
}
```


---

### äº”ã€ç½‘ç»œåŒæ­¥åè°ƒå™¨ï¼ˆå¤šäººæ¸¸æˆï¼‰

#### åœºæ™¯æè¿°ï¼š
åœ¨å¤šäººæ¸¸æˆä¸­ï¼Œæœ¬åœ°æ“ä½œéœ€åŒæ­¥åˆ°æœåŠ¡å™¨ï¼ŒåŒæ—¶æ¥æ”¶æ¥è‡ªå…¶ä»–ç©å®¶çš„æ“ä½œæ•°æ®ã€‚

#### ä½¿ç”¨ä¸­ä»‹è€…çš„å¥½å¤„ï¼š
ä¸­ä»‹è€…å¯ä»¥é›†ä¸­å¤„ç†æœ¬åœ°è¾“å…¥ã€ç½‘ç»œåŒæ­¥ã€çŠ¶æ€æ›´æ–°ç­‰é€»è¾‘ï¼Œé¿å…å„æ¨¡å—ä¹‹é—´ç›¸äº’ä¾èµ–ã€‚

---

### æ€»ç»“ï¼šä¸­ä»‹è€…æ¨¡å¼åœ¨æ¸¸æˆå¼€å‘ä¸­çš„å¸¸è§ä½¿ç”¨åœºæ™¯

| ä½¿ç”¨åœºæ™¯ | æè¿° |
|----------|------|
| ğŸ® æ¸¸æˆå¯¹è±¡é€šä¿¡ | ç©å®¶ã€æ•Œäººã€UIã€éŸ³æ•ˆç­‰å¯¹è±¡ä¹‹é—´çš„åè°ƒé€šä¿¡ |
| â³ æ¸¸æˆçŠ¶æ€ç®¡ç† | ç»Ÿä¸€ç®¡ç†æ¸¸æˆçŠ¶æ€åˆ‡æ¢å¹¶é€šçŸ¥ç›¸å…³æ¨¡å— |
| ğŸ§± UIè”åŠ¨ | å¤šä¸ªUIç»„ä»¶ä¹‹é—´çš„çŠ¶æ€åŒæ­¥å’Œå“åº” |
| ğŸ”” äº‹ä»¶å¹¿æ’­ | è½»é‡çº§äº‹ä»¶ç³»ç»Ÿå®ç°æ¨¡å—é—´è§£è€¦ |
| ğŸŒ ç½‘ç»œåŒæ­¥ | åè°ƒæœ¬åœ°è¾“å…¥ä¸è¿œç¨‹åŒæ­¥æ•°æ® |

---

### å»ºè®®

- ä¸­ä»‹è€…é€‚ç”¨äº**ä¸­å¤§å‹é¡¹ç›®**ï¼Œå°¤å…¶æ˜¯æ¨¡å—ä¹‹é—´äº¤äº’é¢‘ç¹ä¸”ç»“æ„å¤æ‚çš„æƒ…å†µã€‚
- å¯¹äºå°å‹é¡¹ç›®æˆ–ç®€å•äº¤äº’ï¼Œåº”æƒè¡¡æ˜¯å¦å¼•å…¥è¯¥æ¨¡å¼ä»¥é¿å…è¿‡åº¦è®¾è®¡ã€‚
- å¯ç»“åˆè§‚å¯Ÿè€…æ¨¡å¼ã€å‘½ä»¤æ¨¡å¼ç­‰è¿›ä¸€æ­¥å¢å¼ºç³»ç»Ÿçš„çµæ´»æ€§å’Œæ‰©å±•æ€§ã€‚

å¦‚æœä½ æ­£åœ¨å¼€å‘å…·ä½“çš„æ¸¸æˆæ¨¡å—ï¼Œæˆ‘å¯ä»¥å¸®ä½ è®¾è®¡å…·ä½“çš„ä¸­ä»‹è€…ç»“æ„ï¼æ¬¢è¿ç»§ç»­æé—®ã€‚